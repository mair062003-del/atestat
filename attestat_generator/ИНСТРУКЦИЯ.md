# Инструкция по использованию генератора аттестатов

Это приложение автоматически создает аттестаты в формате Word (.docx) на основе данных из Excel файла.

## Структура проекта
- `attestat_generator/` - папка с программой
  - `data_loader.py` - скрипт для чтения Excel
  - `main.py` - основной запускаемый файл
  - `subjects_mapping.json` - файл с переводами предметов (Каз -> Рус)
  - `templates/` - папка для шаблонов
    - `template.docx` - ваш шаблон аттестата
  - `output/` - папка, куда сохраняются готовые аттестаты

## 1. Подготовка данных (Excel)
Убедитесь, что ваш Excel файл находится по пути `data/ПОЛОТНО - 4аКШИ - 2021-2022.xlsx`.
Программа считывает данные с листа "Лист2", начиная с 11-й строки.

## 2. Настройка перевода предметов
В файле `attestat_generator/subjects_mapping.json` находится список всех предметов.
Вам нужно открыть этот файл и вписать русские названия вместо "ПЕРЕВЕСТИ".
Пример:
```json
"Математика": {
    "kz": "Математика",
    "ru": "Математика"
}
```

## 3. Создание шаблона (Word)
Самый важный шаг — создать правильный шаблон `template.docx` в папке `templates`.
Используйте обычный Word файл. В нужные места вставьте специальные метки:

- `{{ student_name_kz }}` — ФИО студента на казахском
- `{{ student_name_ru }}` — ФИО студента на русском (сейчас берется из Excel как есть, если нужно транслитерировать, скажите)
- `{{ date }}` — текущая дата

### Таблица с оценками (Сложный вариант)
Если у вас сложная структура (как на фото), где предметы разбиты по модулям, используйте прямой доступ по имени предмета.
В `subjects_mapping.json` посмотрите русское название предмета.
В шаблоне используйте:
- `{{ s['Математика'].name_kz }}` — Название на казахском
- `{{ s['Математика'].score }}` — Оценка (число/процент)
- `{{ s['Математика'].letter }}` — Оценка (буква, например A)
- `{{ s['Математика'].point }}` — Балл (цифра, например 4.0)

Пример строки таблицы для Математики:
| Математика | {{ s['Математика'].name_kz }} | {{ s['Математика'].score }} | {{ s['Математика'].letter }} | {{ s['Математика'].point }} |

Таким образом вы можете сами расставить предметы в нужном порядке в таблице Word.

### Таблица с оценками (Простой вариант - список)
Чтобы оценки заполнились автоматически списком...

## 4. Запуск программы (Веб-интерфейс)
1. Откройте командную строку (Terminal).
2. Перейдите в папку проекта:
   ```bash
   cd Desktop/Atestat\ 2026/attestat_generator
   ```
3. Запустите веб-приложение:
   ```bash
   streamlit run app.py
   ```
4. В браузере откроется страница, где можно загрузить файлы и скачать готовый архив.

По вопросам доработки (например, добавления склонения имен или другой логики) обращайтесь!
